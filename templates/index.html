<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speech Recognition and Sentiment Analysis</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <script src="https://cdn.socket.io/4.5.1/socket.io.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>Speech Recognition and Sentiment Analysis</h1>

        
        <div id="recording-section">
            <h2>Live Speech Input</h2>
            <button id="start-recording" class="btn">Start Recording</button>
            <button id="stop-recording" class="btn">Stop Recording</button>
            <h3>Transcription:</h3>
            <p id="live-transcription">Waiting for input...</p>
            <h3>Sentiment Analysis:</h3>
            <p id="live-sentiment">Waiting for sentiment analysis...</p>
            <h3>Sentiment Score:</h3>
            <p id="live-sentiment-score">Waiting for sentiment score...</p>
        </div>

        <hr>

        
        <div id="upload-section">
            <h2>Upload Audio File</h2>
            <form id="upload-form">
                <input type="file" id="audio-file" accept="audio/*">
                <button type="submit" class="btn">Upload and Process</button>
            </form>
            <h3>Transcription:</h3>
            <p id="file-transcription">Waiting for input...</p>
            <h3>Sentiment Analysis:</h3>
            <p id="file-sentiment">Waiting for sentiment analysis...</p>
            <h3>Sentiment Score:</h3>
            <p id="file-sentiment-score">Waiting for sentiment score...</p>
        </div>

        <hr>

        
        <div id="sentiment-shift-section">
            <h2>Sentiment Shift Analysis</h2>
            <p id="sentiment-shift">No sentiment shift detected yet.</p>
        </div>

        <hr>

        
        <div id="pdf-download-section">
            <h2>Download Results</h2>
            <button id="download-pdf" class="btn">Download PDF</button>
        </div>
    </div>

    <script>
        const socket = io.connect();

        // Live Recording
        const startBtn = document.getElementById('start-recording');
        const stopBtn = document.getElementById('stop-recording');
        const liveTranscription = document.getElementById('live-transcription');
        const liveSentiment = document.getElementById('live-sentiment');
        const liveSentimentScore = document.getElementById('live-sentiment-score');
        const sentimentShift = document.getElementById('sentiment-shift');

        let previousSentimentScore = null;

        startBtn.addEventListener('click', () => {
            socket.emit('start_recording');
            liveTranscription.innerText = 'Listening...';
        });

        stopBtn.addEventListener('click', () => {
            socket.emit('stop_recording');
            liveTranscription.innerText = 'Stopped listening.';
        });

        socket.on('transcript', (data) => {
            liveTranscription.innerText = data.text;
        });

        socket.on('sentiment', (data) => {
            liveSentiment.innerText = `Sentiment: ${data.sentiment}`;
            liveSentimentScore.innerText = `Sentiment Score: ${data.score}`;

            if (previousSentimentScore !== null) {
                const shift = data.score - previousSentimentScore;
                sentimentShift.innerText = `Sentiment Shift: ${shift > 0 ? `+${shift.toFixed(2)}` : shift.toFixed(2)}`;
            }

            previousSentimentScore = data.score;
        });

        // File Upload
        const uploadForm = document.getElementById('upload-form');
        const audioFileInput = document.getElementById('audio-file');
        const fileTranscription = document.getElementById('file-transcription');
        const fileSentiment = document.getElementById('file-sentiment');
        const fileSentimentScore = document.getElementById('file-sentiment-score');

        uploadForm.addEventListener('submit', (event) => {
            event.preventDefault();
            const formData = new FormData();
            const file = audioFileInput.files[0];
            if (!file) {
                alert('Please select an audio file to upload.');
                return;
            }

            formData.append('audio', file);

            fetch('/upload', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                fileTranscription.innerText = data.transcript;
                fileSentiment.innerText = `Sentiment: ${data.sentiment}`;
                fileSentimentScore.innerText = `Sentiment Score: ${data.score}`;
            })
            .catch(error => {
                console.error('Error uploading file:', error);
            });
        });

        // PDF Download
        const downloadPdfBtn = document.getElementById('download-pdf');
        downloadPdfBtn.addEventListener('click', () => {
            window.location.href = '/download_pdf';
        });
    </script>
</body>
</html>  -->



<!-- m3 -->
<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Recommendation & Dynamic Questions</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <script src="https://cdn.socket.io/4.5.1/socket.io.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>Real-Time Product Recommendation</h1>

        <div id="recording-section">
            <h2>Live Speech Input</h2>
            <button id="start-recording" class="btn">Start Recording</button>
            <button id="stop-recording" class="btn">Stop Recording</button>
            <h3>Transcription:</h3>
            <p id="live-transcription">Waiting for input...</p>
            <h3>Product Recommendations:</h3>
            <ul id="recommendations"></ul>
            <h3>Dynamic Questions:</h3>
            <ul id="dynamic-questions"></ul>
        </div>

        <hr>

        <div id="upload-section">
            <h2>Upload Audio File</h2>
            <form id="upload-form">
                <input type="file" id="audio-file" accept="audio/*">
                <button type="submit" class="btn">Upload and Process</button>
            </form>
            <h3>Transcription:</h3>
            <p id="file-transcription">Waiting for input...</p>
            <h3>Product Recommendations:</h3>
            <ul id="file-recommendations"></ul>
            <h3>Dynamic Questions:</h3>
            <ul id="file-dynamic-questions"></ul>
        </div>

        <hr>

        <div id="pdf-download-section">
            <h2>Download Results</h2>
            <button id="download-pdf" class="btn">Download PDF</button>
        </div>
    </div>

    <script>
        const socket = io.connect();

        const startBtn = document.getElementById('start-recording');
        const stopBtn = document.getElementById('stop-recording');
        const liveTranscription = document.getElementById('live-transcription');
        const recommendationsList = document.getElementById('recommendations');
        const dynamicQuestionsList = document.getElementById('dynamic-questions');

        startBtn.addEventListener('click', () => {
            socket.emit('start_recording');
            liveTranscription.innerText = 'Listening...';
        });

        stopBtn.addEventListener('click', () => {
            socket.emit('stop_recording');
            liveTranscription.innerText = 'Stopped listening.';
        });

        socket.on('transcript', (data) => {
            liveTranscription.innerText = data.text;
        });

        socket.on('analysis', (data) => {
            recommendationsList.innerHTML = data.recommendations.map(item => `<li>${item}</li>`).join('');
            dynamicQuestionsList.innerHTML = data.questions.map(item => `<li>${item}</li>`).join('');
        });

        const uploadForm = document.getElementById('upload-form');
        const audioFileInput = document.getElementById('audio-file');
        const fileTranscription = document.getElementById('file-transcription');
        const fileRecommendations = document.getElementById('file-recommendations');
        const fileDynamicQuestions = document.getElementById('file-dynamic-questions');

        uploadForm.addEventListener('submit', (event) => {
            event.preventDefault();
            const formData = new FormData();
            const file = audioFileInput.files[0];
            if (!file) {
                alert('Please select an audio file to upload.');
                return;
            }

            formData.append('audio', file);

            fetch('/upload', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                fileTranscription.innerText = data.transcript;
                fileRecommendations.innerHTML = data.recommendations.map(item => `<li>${item}</li>`).join('');
                fileDynamicQuestions.innerHTML = data.questions.map(item => `<li>${item}</li>`).join('');
            })
            .catch(error => {
                console.error('Error uploading file:', error);
            });
        });

        const downloadPdfBtn = document.getElementById('download-pdf');
        downloadPdfBtn.addEventListener('click', () => {
            window.location.href = '/download_pdf';
        });
    </script>
</body>
</html> -->


<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Recommendation & Dynamic Questions</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <script src="https://cdn.socket.io/4.5.1/socket.io.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>Real-Time Product Recommendation</h1>

        <div id="recording-section">
            <h2>Live Speech Input</h2>
            <button id="start-recording" class="btn">Start Recording</button>
            <button id="stop-recording" class="btn">Stop Recording</button>
            <h3>Transcription:</h3>
            <p id="live-transcription">Waiting for input...</p>
            <h3>Sentiment:</h3>
            <p id="sentiment">No data yet.</p>
            <h3>Sentiment Shift:</h3>
            <p id="sentiment-shift">No shift detected.</p>
            <h3>Product Recommendations:</h3>
            <ul id="recommendations"></ul>
            <h3>Dynamic Questions:</h3>
            <ul id="dynamic-questions"></ul>
        </div>

        <hr>

        <div id="upload-section">
            <h2>Upload Audio File</h2>
            <form id="upload-form">
                <input type="file" id="audio-file" accept="audio/*">
                <button type="submit" class="btn">Upload and Process</button>
            </form>
            <h3>Transcription:</h3>
            <p id="file-transcription">Waiting for input...</p>
            <h3>Sentiment:</h3>
            <p id="file-sentiment">No data yet.</p>
            <h3>Product Recommendations:</h3>
            <ul id="file-recommendations"></ul>
            <h3>Dynamic Questions:</h3>
            <ul id="file-dynamic-questions"></ul>
        </div>

        <hr>

        <div id="pdf-download-section">
            <h2>Download Results</h2>
            <button id="download-pdf" class="btn">Download PDF</button>
        </div>
    </div>

    <script>
        const socket = io.connect();

        const startBtn = document.getElementById('start-recording');
        const stopBtn = document.getElementById('stop-recording');
        const liveTranscription = document.getElementById('live-transcription');
        const sentiment = document.getElementById('sentiment');
        const sentimentShift = document.getElementById('sentiment-shift');
        const recommendationsList = document.getElementById('recommendations');
        const dynamicQuestionsList = document.getElementById('dynamic-questions');

        startBtn.addEventListener('click', () => {
            socket.emit('start_recording');
            liveTranscription.innerText = 'Listening...';
        });

        stopBtn.addEventListener('click', () => {
            socket.emit('stop_recording');
            liveTranscription.innerText = 'Stopped listening.';
        });

        socket.on('transcript', (data) => {
            liveTranscription.innerText = data.text;
        });

        socket.on('analysis', (data) => {
            sentiment.innerText = `Sentiment: ${data.sentiment} (Score: ${data.score})`;
            sentimentShift.innerText = data.shift || "No shift detected.";
            recommendationsList.innerHTML = data.recommendations.map(item => `<li>${item}</li>`).join('');
            dynamicQuestionsList.innerHTML = data.questions.map(item => `<li>${item}</li>`).join('');
        });

        const uploadForm = document.getElementById('upload-form');
        const audioFileInput = document.getElementById('audio-file');
        const fileTranscription = document.getElementById('file-transcription');
        const fileRecommendations = document.getElementById('file-recommendations');
        const fileDynamicQuestions = document.getElementById('file-dynamic-questions');

        uploadForm.addEventListener('submit', (event) => {
            event.preventDefault();
            const formData = new FormData();
            const file = audioFileInput.files[0];
            if (!file) {
                alert('Please select an audio file to upload.');
                return;
            }

            formData.append('audio', file);

            fetch('/upload', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                fileTranscription.innerText = data.transcript;
                fileRecommendations.innerHTML = data.recommendations.map(item => `<li>${item}</li>`).join('');
                fileDynamicQuestions.innerHTML = data.questions.map(item => `<li>${item}</li>`).join('');
            })
            .catch(error => {
                console.error('Error uploading file:', error);
            });
        });

        const downloadPdfBtn = document.getElementById('download-pdf');
        downloadPdfBtn.addEventListener('click', () => {
            window.location.href = '/download_pdf';
        });
    </script>
</body>
</html> -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Recommendation & Dynamic Questions</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <script src="https://cdn.socket.io/4.5.1/socket.io.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>Real-Time Product Recommendation</h1>

        <div id="recording-section">
            <h2>Live Speech Input</h2>
            <button id="start-recording" class="btn">Start Recording</button>
            <button id="stop-recording" class="btn">Stop Recording</button>
            <h3>Transcription:</h3>
            <p id="live-transcription">Waiting for input...</p>
            <h3>Sentiment:</h3>
            <p id="sentiment">No data yet.</p>
            <h3>Sentiment Shift:</h3>
            <p id="sentiment-shift">No shift detected.</p>
            <h3>Product Recommendations:</h3>
            <ul id="recommendations"></ul>
            <h3>Dynamic Questions:</h3>
            <ul id="dynamic-questions"></ul>
        </div>

        <hr>

        <div id="upload-section">
            <h2>Upload Audio File</h2>
            <form id="upload-form">
                <input type="file" id="audio-file" accept="audio/*">
                <button type="submit" class="btn">Upload and Process</button>
            </form>
            <h3>Transcription:</h3>
            <p id="file-transcription">Waiting for input...</p>
            <h3>Sentiment:</h3>
            <p id="file-sentiment">No data yet.</p>
            <h3>Product Recommendations:</h3>
            <ul id="file-recommendations"></ul>
            <h3>Dynamic Questions:</h3>
            <ul id="file-dynamic-questions"></ul>
        </div>

        <hr>

        <div id="pdf-download-section">
            <h2>Download Results</h2>
            <button id="download-pdf" class="btn">Download PDF</button>
        </div>
    </div>

    <script>
        const socket = io.connect();

        const startBtn = document.getElementById('start-recording');
        const stopBtn = document.getElementById('stop-recording');
        const transcriptionDiv = document.getElementById('live-transcription');
        const sentimentDiv = document.getElementById('sentiment');
        const sentimentShiftDiv = document.getElementById('sentiment-shift');
        const recommendationsList = document.getElementById('recommendations');
        const questionsList = document.getElementById('dynamic-questions');

        startBtn.addEventListener('click', () => {
            socket.emit('start_recording');
            liveTranscription.innerText = 'Listening...';
        });

        stopBtn.addEventListener('click', () => {
            socket.emit('stop_recording');
            liveTranscription.innerText = 'Stopped listening.';
        });

        socket.on('transcript', (data) => {
            transcriptionDiv.innerText = data.text;
        });

        socket.on('analysis', (data) => {
            sentimentDiv.innerText = data.sentiment;
            sentimentShiftDiv.innerText = data.shift || "No shift detected.";
            recommendationsList.innerHTML = data.recommendations.map(item => `<li>${item}</li>`).join('');
            questionsList.innerHTML = data.questions.map(item => `<li>${item}</li>`).join('');
        });

        document.getElementById('upload-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const formData = new FormData();
            formData.append('audio', document.getElementById('audio-file').files[0]);

            fetch('/upload', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('file-transcription').innerText = data.transcript;
                document.getElementById('file-sentiment').innerText = data.sentiment;
                document.getElementById('file-recommendations').innerHTML = data.recommendations.map(item => `<li>${item}</li>`).join('');
                document.getElementById('file-dynamic-questions').innerHTML = data.questions.map(item => `<li>${item}</li>`).join('');
            });
        });

        document.getElementById('download-pdf').addEventListener('click', () => {
            window.location.href = '/download_pdf';
        });
    </script>
</body>
</html>

